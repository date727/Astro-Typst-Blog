---
export interface Props {
  term?: string;
}
const { term } = Astro.props;
---
<div id="giscus"></div>

<script>
  // 确保在每次页面加载时都重新初始化Giscus
  document.addEventListener('astro:page-load', () => {
    // 清除现有的Giscus实例
    const giscusContainer = document.getElementById('giscus');
    if (giscusContainer) {
      giscusContainer.innerHTML = '';
    }
    
    // 重新加载Giscus脚本
    const script = document.createElement('script');
    script.src = 'https://giscus.app/client.js';
    script.setAttribute('data-repo', 'date727/Astro-Typst-Blog');
    script.setAttribute('data-repo-id', 'R_kgDOPg6N0A');
    script.setAttribute('data-category', 'General');
    script.setAttribute('data-category-id', 'DIC_kwDOPg6N0M4CuY4o');
    script.setAttribute('data-mapping', 'pathname');
    script.setAttribute('data-strict', '0');
    script.setAttribute('data-reactions-enabled', '1');
    script.setAttribute('data-emit-metadata', '0');
    script.setAttribute('data-input-position', 'bottom');
    script.setAttribute('data-theme', 'noborder_light');
    script.setAttribute('data-lang', 'zh-CN');
    script.setAttribute('crossorigin', 'anonymous');
    script.async = true;
    
    giscusContainer.appendChild(script);
  });
</script>