---
import { getCollection, render } from 'astro:content';

/* 1. 在构建时告诉 Astro 有哪些文章要生成 */
export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.id },   // 匹配 /blog/文章id/
    props: { post },
  }));
}

/* 2. 拿到当前这篇文章 */
const { post } = Astro.props;
const { Content } = await render(post);
---

<html lang="zh-cn">
  <head>
    <meta charset="utf-8" />
    <title>{post.data.title}</title>
  </head>
  <body>
    <nav>
      <a href="/">首页</a>
      <a href="/blog/">← 返回列表</a>
    </nav>

    <article>
      <h1>{post.data.title}</h1>
      <time>{post.data.date.toLocaleDateString()}</time>
      <Content />
    </article>
  </body>
</html>